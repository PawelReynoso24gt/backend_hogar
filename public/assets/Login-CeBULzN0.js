import{_ as I,r as p,I as k,J as S,d as g,k as o,w as e,a,b as h,K as B,q as E,v as G,m as i,y as N,x as T,l as j}from"./index-Dv1Q5dJW.js";import{a as D}from"./axios-B4uVmeYG.js";const U={name:"Login",setup(){const _=p(""),s=p(""),n=p(null),t=p(!1),r=p(""),m=k(),c=S();return{usuarios:_,contrasenias:s,tipoProyecto:n,showPassword:t,error:r,togglePasswordVisibility:()=>{t.value=!t.value},login:async()=>{if(!n.value){r.value="Por favor, selecciona un tipo de proyecto";return}try{r.value="",console.log("Usuario:",_.value),console.log("Contraseña:",s.value),console.log("Tipo de proyecto:",n.value);const l=await D.post("http://hogarsantaluisa.test/logins/authenticate",{usuarios:_.value,contrasenias:s.value,tipoProyecto:n.value});if(l.status===200){console.log("Autenticación exitosa"),localStorage.setItem("token",l.data.token),localStorage.setItem("tipoProyecto",n.value);const C=n.value==="agricola"?"1":"2";c.dispatch("updateSelectedProject",n.value==="agricola"?"Proyecto Agrícola":"Proyecto Capilla"),c.dispatch("updateProjectToken",C),n.value==="agricola"?m.push("/theme/colors"):n.value==="capilla"&&m.push("/honey123")}else console.error("Error de inicio de sesión: Datos de autenticación no válidos"),r.value="Datos de autenticación no válidos"}catch(l){console.error("Error de inicio de sesión:",l),l.response&&l.response.status===403?r.value="Este usuario no está habilitado":r.value="Error de inicio de sesión. Por favor, inténtelo de nuevo."}}}}},F={class:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},A=i("h1",null,"BIENVENIDOS!",-1),L=i("p",{class:"text-body-secondary"},"Inicia sesión con tu usuario!",-1),R=i("option",{value:null,disabled:""},"Seleccionar tipo de proyecto",-1),M=i("option",{value:"agricola"},"Proyecto Agrícola",-1),q=i("option",{value:"capilla"},"Proyecto Capilla",-1),J=[R,M,q],K={key:0,class:"text-danger"};function O(_,s,n,t,r,m){const c=a("font-awesome-icon"),u=a("CInputGroupText"),f=a("CFormInput"),l=a("CInputGroup"),C=a("CButton"),v=a("CCol"),y=a("CRow"),w=a("CForm"),P=a("CCardBody"),x=a("CCard"),b=a("CCardGroup"),V=a("CContainer");return h(),g("div",F,[o(V,null,{default:e(()=>[o(y,{class:"justify-content-center"},{default:e(()=>[o(v,{md:8},{default:e(()=>[o(b,null,{default:e(()=>[o(x,{class:"p-4"},{default:e(()=>[o(P,null,{default:e(()=>[o(w,{onSubmit:B(t.login,["prevent"])},{default:e(()=>[A,L,o(l,{class:"mb-3"},{default:e(()=>[o(u,null,{default:e(()=>[o(c,{icon:["fas","user"]})]),_:1}),o(f,{modelValue:t.usuarios,"onUpdate:modelValue":s[0]||(s[0]=d=>t.usuarios=d),placeholder:"Usuario",autocomplete:"usuarios"},null,8,["modelValue"])]),_:1}),o(l,{class:"mb-3"},{default:e(()=>[o(u,null,{default:e(()=>[o(c,{icon:["fas","lock"]})]),_:1}),o(f,{type:t.showPassword?"text":"password",modelValue:t.contrasenias,"onUpdate:modelValue":s[1]||(s[1]=d=>t.contrasenias=d),placeholder:"Contraseña",autocomplete:"contrasenias"},null,8,["type","modelValue"]),o(u,{onClick:t.togglePasswordVisibility},{default:e(()=>[o(c,{icon:["fas",t.showPassword?"eye-slash":"eye"]},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),o(l,{class:"mb-4"},{default:e(()=>[o(u,null,{default:e(()=>[o(c,{icon:["fas","project-diagram"]})]),_:1}),E(i("select",{"onUpdate:modelValue":s[2]||(s[2]=d=>t.tipoProyecto=d),class:"form-select"},J,512),[[G,t.tipoProyecto]])]),_:1}),t.error?(h(),g("p",K,N(t.error),1)):T("",!0),o(y,null,{default:e(()=>[o(v,{xs:6},{default:e(()=>[o(C,{type:"submit",color:"primary",class:"px-4"},{default:e(()=>[j("Login")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const Q=I(U,[["render",O]]);export{Q as default};
